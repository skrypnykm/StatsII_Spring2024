\documentclass[12pt,letterpaper]{article}
\usepackage{graphicx,textcomp}
\usepackage{natbib}
\usepackage{setspace}
\usepackage{fullpage}
\usepackage{color}
\usepackage[reqno]{amsmath}
\usepackage{amsthm}
\usepackage{fancyvrb}
\usepackage{amssymb,enumerate}
\usepackage[all]{xy}
\usepackage{endnotes}
\usepackage{lscape}
\newtheorem{com}{Comment}
\usepackage{float}
\usepackage{hyperref}
\newtheorem{lem} {Lemma}
\newtheorem{prop}{Proposition}
\newtheorem{thm}{Theorem}
\newtheorem{defn}{Definition}
\newtheorem{cor}{Corollary}
\newtheorem{obs}{Observation}
\usepackage[compact]{titlesec}
\usepackage{dcolumn}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usepackage{multirow}
\usepackage{xcolor}
\newcolumntype{.}{D{.}{.}{-1}}
\newcolumntype{d}[1]{D{.}{.}{#1}}
\definecolor{light-gray}{gray}{0.65}
\usepackage{url}
\usepackage{listings}
\usepackage{color}
\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{siunitx} 

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
	backgroundcolor=\color{backcolour},   
	commentstyle=\color{codegreen},
	keywordstyle=\color{magenta},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{codepurple},
	basicstyle=\footnotesize,
	breakatwhitespace=false,         
	breaklines=true,                 
	captionpos=b,                    
	keepspaces=true,                 
	numbers=left,                    
	numbersep=5pt,                  
	showspaces=false,                
	showstringspaces=false,
	showtabs=false,                  
	tabsize=2
}
\lstset{style=mystyle}
\newcommand{\Sref}[1]{Section~\ref{#1}}
\newtheorem{hyp}{Hypothesis}

\title{Problem Set 3}
\date{Due: March 24, 2024}
\author{Applied Stats II \\ \vspace{\baselineskip}
	\textbf{Maiia Skrypnyk 23371609}}



\begin{document}
	\maketitle
	\section*{Instructions}
	\begin{itemize}
	\item Please show your work! You may lose points by simply writing in the answer. If the problem requires you to execute commands in \texttt{R}, please include the code you used to get your answers. Please also include the \texttt{.R} file that contains your code. If you are not sure if work needs to be shown for a particular problem, please ask.
\item Your homework should be submitted electronically on GitHub in \texttt{.pdf} form.
\item This problem set is due before 23:59 on Sunday March 24, 2024. No late assignments will be accepted.
	\end{itemize}

	\vspace{.25cm}
\section*{Question 1}
\vspace{.25cm}
\noindent We are interested in how governments' management of public resources impacts economic prosperity. Our data come from \href{https://www.researchgate.net/profile/Adam_Przeworski/publication/240357392_Classifying_Political_Regimes/links/0deec532194849aefa000000/Classifying-Political-Regimes.pdf}{Alvarez, Cheibub, Limongi, and Przeworski (1996)} and is labelled \texttt{gdpChange.csv} on GitHub. The dataset covers 135 countries observed between 1950 or the year of independence or the first year forwhich data on economic growth are available ("entry year"), and 1990 or the last year for which data on economic growth are available ("exit year"). The unit of analysis is a particular country during a particular year, for a total $>$ 3,500 observations. 

\begin{itemize}
	\item
	Response variable: 
	\begin{itemize}
		\item \texttt{GDPWdiff}: Difference in GDP between year $t$ and $t-1$. Possible categories include: "positive", "negative", or "no change"
	\end{itemize}
	\item
	Explanatory variables: 
	\begin{itemize}
		\item
		\texttt{REG}: 1=Democracy; 0=Non-Democracy
		\item
		\texttt{OIL}: 1=if the average ratio of fuel exports to total exports in 1984-86 exceeded 50\%; 0= otherwise
	\end{itemize}
	
\end{itemize}
\newpage
\noindent Please answer the following questions:

\begin{enumerate}
	\item Construct and interpret an unordered multinomial logit with \texttt{GDPWdiff} as the output and "no change" as the reference category, including the estimated cutoff points and coefficients.
	
		\vspace{.25cm}
	\textbf{Loading the data:}
	\lstinputlisting[language=R, firstline=40, lastline=40]{PS3MS.R} 
	
	\vspace{.25cm}
	\textbf{Preparing the data:}
	\lstinputlisting[language=R, firstline=42, lastline=47]{PS3MS.R} 

 Essentially, by manually categorising the numerical observations of the outcome variable into three groups, we are embedding the cutoff points of $<0$, 0, $>0$ into the model estimation process.
	
		\vspace{.25cm}
	\textbf{Constructing an unordered multinomial logit model:}
	\lstinputlisting[language=R, firstline=50, lastline=52]{PS3MS.R} 
	
	\vspace{3cm}
\begin{center}
		\textit{	(Please see the summary table on the next page)}
\end{center}
	
	\begin{table}[H] \centering   \caption{Unordered Multinomial Logit Model}   \label{} \begin{tabular}{@{\extracolsep{5pt}}lcc} \\[-1.8ex]\hline \hline \\[-1.8ex]  & \multicolumn{2}{c}{\textit{Dependent variable:}} \\ \cline{2-3} \\[-1.8ex] & negative & positive \\ \\[-1.8ex] & (1) & (2)\\ \hline \\[-1.8ex]  REG & 1.379$^{*}$ & 1.769$^{**}$ \\   & (0.769) & (0.767) \\   & & \\  OIL & 4.784 & 4.576 \\   & (6.885) & (6.885) \\   & & \\  Constant & 3.805$^{***}$ & 4.534$^{***}$ \\   & (0.271) & (0.269) \\   & & \\ \hline \\[-1.8ex] Akaike Inf. Crit. & 4,690.770 & 4,690.770 \\ \hline \hline \\[-1.8ex] \textit{Note:}  & \multicolumn{2}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ \end{tabular} \end{table} 
	
	Let's exponentiate the coefficients and add confidence intervals for a more intuitive interpretation to follow: 
	
		\lstinputlisting[language=R, firstline=58, lastline=59]{PS3MS.R} 
	
	\begin{table}[H] \centering   \caption{Unordered Multinomial Logit Model  (OR)}   \label{} \begin{tabular}{@{\extracolsep{5pt}} cccc} \\[-1.8ex]\hline \hline \\[-1.8ex]  & (Intercept) & REG & OIL \\ \hline \\[-1.8ex] negative & $44.942$ & $3.972$ & $119.578$ \\ positive & $93.108$ & $5.865$ & $97.156$ \\ \hline \\[-1.8ex] \end{tabular} \end{table} 
	

	\begin{itemize}
	\item \textbf{Intercept (negative), 44.942: }  On average, when a country is non-democratic and does not produce any oil, the baseline odds of going from having no change in GDP difference to a negative GDP difference  $\approx 44.942$.  
	\item \textbf{Intercept (positive), 93.108: } On average, when a country is non-democratic and does not produce any oil, the baseline odds of going from having no change in GDP difference to a positive GDP difference  $\approx 93.108$. 
	
\textit{Both intercepts are statistically differentiable from zero at the $\alpha$-level = 0.05.  }
	\item \textbf{REG(negative), 3.972}: On average and holding all the other predictors constant, a shift from being a non-democratic to a democratic country is associated with an increase by a multiplicative factor of 3.972 in the odds of going from having no change in GDP difference to a negative GDP difference. 
	\item \textbf{REG(positive), 5.865}: On average and holding all the other predictors constant, a shift from being a non-democratic to a democratic country is associated with an increase by a multiplicative factor of 5.865 in the odds of going from having no change in GDP difference to a positive GDP difference. \textit{The coefficient is statistically differentiable from zero at the $\alpha$-level = 0.05.}
	\item \textbf{OIL(negative), 119.578}: On average and holding all the other predictors constant, a shift from not producing oil to producing oil for a country  is associated with an increase by a multiplicative factor of 119.578 in the odds of going from having no change in GDP difference to a negative GDP difference.
	\item \textbf{OIL(positive), 97.156}: On average and holding all the other predictors constant, a shift from not producing oil to producing oil for a country  is associated with an increase by a multiplicative factor of 97.156 in the odds of going from having no change in GDP difference to a positive GDP difference.
	\end{itemize}

	
	\item Construct and interpret an ordered multinomial logit with \texttt{GDPWdiff} as the outcome variable, including the estimated cutoff points and coefficients.

 	\textbf{Preparing the data:}

	\lstinputlisting[language=R, firstline=64, lastline=65]{PS3MS.R} 
 
		\textbf{Constructing an ordered multinomial logit model:}

	\lstinputlisting[language=R, firstline=68, lastline=70]{PS3MS.R} 

 \vspace{3cm}
\begin{center}
		\textit{	(Please see the summary table on the next page)}
\end{center}

	\begin{table}[H] 
\centering 
\caption{Ordered Multinomial Logit Model} 
\label{} 
\begin{tabular}{lccc} 
\hline 
\hline 
& \multicolumn{3}{c}{\textit{Dependent Variable: GDPWdiff1}} \\
\cline{2-4} 
& Value & Std. Error & t-value \\ 
\hline 
REG & 0.398*** & 0.075 & 5.300 \\ 
OIL & -0.199* & 0.116 & -1.717 \\ 
\hline 
\multicolumn{4}{l}{\textbf{Intercepts:}} \\
\hline 
& Value & Std. Error & t-value \\ 
\hline 
negative|no change & -0.731 & 0.048 & -15.360 \\
no change|positive & -0.711 & 0.048 & -14.955 \\
positive|TRUE & 1232.909 & 0.048 & 25952.256 \\

\hline \\[-1.8ex] 
\multicolumn{4}{l}{Observations: 3,721}  \\ 
\multicolumn{4}{l}{Residual Deviance: 4687.689} \\
\multicolumn{4}{l}{AIC: 4697.689} \\
\hline 
\hline \\[-1.8ex] 
\textit{Note:}  & \multicolumn{1}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
\hline 
\end{tabular} 
\end{table}


		Let's exponentiate the coefficients and add confidence intervals for a more intuitive interpretation to follow: 
	
	\lstinputlisting[language=R, firstline=76, lastline=77]{PS3MS.R} 
	
	
	\begin{table}[H] 
\centering 
\caption{Ordered Multinomial Logit Model (OR)} 
\begin{tabular}{lccc} 
\hline 
& OR & 2.5\% & 97.5\% \\ 
\hline 
REG & 1.490 & 1.286 & 1.727 \\ 
OIL & 0.820 & 0.655 & 1.031 \\ 
\hline 
\end{tabular} 
\end{table}
\end{enumerate}

\begin{itemize}
	\item \textbf{Intercept: negative-no change, \( \mathbf{e^{-0.731} = 2.07} \)} + \textbf{Intercept: no-change-positive, \( \mathbf{e^{-0.711} = 2.03} \)}: 
 \begin{itemize}
        \item The intercepts are very similar to each other. Therefore, we assume that the "proportional odds"/"parallel regression assumption" holds for the ordered model, which makes sense: the categories we imposed are inherently ordinal (negative $\rightarrow$ no change $\rightarrow$ positive). Thus, also, the effect of the predictors on the outcome variable is the same across all of its categories. 
        \item While the intercepts for the ordered model do not exactly have an intuitive meaning, or an interpretation alike to the ordered model, we might interpret them as the cutoff points for shifting from the lower category of the outcome variable to the higher one.
    \end{itemize} 
 
	\item \textbf{REG, 0.398:} On average and holding all the other predictors constant, a shift from being a non-democratic to a democratic country is associated an increase by a multiplicative factor of 1.490 in the odds of observing a next/higher category (any one of them, "proportional odds"/"parallel regression assumption" again) of the GDP difference. (Increase in odds and probability).
\textit{This coefficient is statistically differentiable from zero at the $\alpha$-level = 0.05.  }
	\item \textbf{OIL, 0.820}: On average and holding all the other predictors constant, a shift from not producing oil to producing oil for a country is associated with a change in odds of observing a next/higher category of the GDP difference by a multiplicative factor of 0.820. (Decrease in odds and probability).
\end{itemize}

\section*{Question 2} 
\vspace{.25cm}

\noindent Consider the data set \texttt{MexicoMuniData.csv}, which includes municipal-level information from Mexico. The outcome of interest is the number of times the winning PAN presidential candidate in 2006 (\texttt{PAN.visits.06}) visited a district leading up to the 2009 federal elections, which is a count. Our main predictor of interest is whether the district was highly contested, or whether it was not (the PAN or their opponents have electoral security) in the previous federal elections during 2000 (\texttt{competitive.district}), which is binary (1=close/swing district, 0="safe seat"). We also include \texttt{marginality.06} (a measure of poverty) and \texttt{PAN.governor.06} (a dummy for whether the state has a PAN-affiliated governor) as additional control variables. 

\begin{enumerate}
	\item [(a)]
	Run a Poisson regression because the outcome is a count variable. Is there evidence that PAN presidential candidates visit swing districts more? Provide a test statistic and p-value.
	
	\vspace{.25cm}
	\textbf{Loading the data:}
	\lstinputlisting[language=R, firstline=84, lastline=84]{PS3MS.R} 
	
	\vspace{.25cm}
	\textbf{Constructing a Poisson model:}
	\lstinputlisting[language=R, firstline=87, lastline=88]{PS3MS.R} 
	

\begin{table}[!htbp] \centering 
  \caption{Poisson Model} 
  \label{} 
\begin{tabular}{@{\extracolsep{5pt}}lcccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & \multicolumn{4}{c}{\textit{Dependent variable:}} \\ 
\cline{2-5} 
\\[-1.8ex] & \multicolumn{4}{c}{PAN.visits.06} \\ 
\\[-1.8ex] & Estimate & Std. Error & z-value & Pr($>$$|$z$|$) \\ 
\hline \\[-1.8ex] 
 (Intercept) & $-$3.810 & 0.222 & $-$17.156 & $<$2e-16$^{***}$ \\ 
  factor(competitive.district)1 & $-$0.081 & 0.171 & $-$0.477 & 0.634 \\ 
  marginality.06 & $-$2.080 & 0.117 & $-$17.728 & $<$2e-16$^{***}$ \\ 
  factor(PAN.governor.06)1 & $-$0.312 & 0.167 & $-$1.869 & 0.062 \\ 
\hline \\[-1.8ex] 
Observations & 2,407 & & & \\ 
Log Likelihood & $-$645.606 & & & \\ 
Akaike Inf. Crit. & 1,299.213 & & & \\ 
\hline 
\hline \\[-1.8ex] 
\textit{Note:}  & \multicolumn{4}{r}{$^{*}$p$<$0.1; $^{**}$p$<$0.05; $^{***}$p$<$0.01} \\ 
\end{tabular} 
\end{table}
	
		Let's exponentiate the coefficients and add confidence intervals for a more intuitive interpretation to follow: 
	
	\lstinputlisting[language=R, firstline=94, lastline=95]{PS3MS.R} 

\begin{table}[H] \centering   \caption{Poisson Model (exp.)}   \label{} \begin{tabular}{@{\extracolsep{5pt}} cccc} \\[-1.8ex]\hline \hline \\[-1.8ex]  & OR & 2.5 \% & 97.5 \% \\ \hline \\[-1.8ex] (Intercept) & $0.022$ & $0.014$ & $0.034$ \\ factor(competitive.district)1 & $0.922$ & $0.666$ & $1.302$ \\ marginality.06 & $0.125$ & $0.099$ & $0.156$ \\ factor(PAN.governor.06)1 & $0.732$ & $0.523$ & $1.007$ \\ \hline \\[-1.8ex] \end{tabular} \end{table} 

The coefficient for \texttt{competitive.district} would mean that for a given district, shifting from being a 'safe bet' to a 'swing' district, on average and holding other predictors constant, is associated with a change in the number of PAN presidential candidate visits by a multiplicative factor of 0.922 (which is essentially a decrease). Anyways, this coefficient
is \textbf{not} statistically differentiable from zero at the $\alpha$-level = 0.05. Therefore, there is no sufficient evidence to reject the null hypothesis that PAN presidential candidates do not visit swing districts more often. In other words, there is no sufficient evidence to say that the candidates visit the 'swing' districts more often than the 'safe' ones.


	\item [(b)]
	Interpret the \texttt{marginality.06} and \texttt{PAN.governor.06} coefficients.
\begin{itemize}
    \item \texttt{marginality.06}, \textbf{0.125}: For a given district, shifting from having an average poverty level (0) to a marginal poverty level (1) is, on average and holding all the other predictors constant, associated with a change in the number of PAN presidential candidate visits by a multiplicative factor of 0.125 (which means a decrease in the number of visits).
    \item \texttt{PAN.governor.06}, \textbf{0.732}: For a given district, shifting from not having a PAN-affiliated governor (0) to having one (1) is, on average and holding all the other predictors constant, associated with a change in the number of PAN presidential candidate visits by a multiplicative factor of 0.732 (which means a decrease in the number of visits).
\end{itemize}


 
	\item [(c)]
	Provide the estimated mean number of visits from the winning PAN presidential candidate for a hypothetical district that was competitive (\texttt{competitive.district}=1), had an average poverty level (\texttt{marginality.06} = 0), and a PAN governor (\texttt{PAN.governor.06}=1).
	
	Just in terms of conducting basic exploratory data analysis, to get an overall idea of the visits frequency, let's calculate the mean number of visits of the winning PAN presidential candidate:
	
		\lstinputlisting[language=R, firstline=101, lastline=101]{PS3MS.R} 
	
	\begin{verbatim}
		[1] 0.09181554
	\end{verbatim}
	
\vspace{.25cm}
\textbf{Poisson regression equation (general):}
\[
\begin{split}
\hat{\textbf{{ln}}(\textbf{\texttt{PAN.visits.06}}_i)} = \hat{\beta}_0 + \hat{\beta}_1 \texttt{competitive.district}_i + \hat{\beta}_2 \texttt{marginality.06}_i + \\
\hat{\beta}_3 \texttt{PAN.governor.06}_i
\end{split}
\]

\[
\begin{split}
\hat{\textbf{{ln}}(\textbf{\texttt{PAN.visits.06}}_i)} &= -3.810 - 0.081 \cdot \texttt{competitive.district}_i - 2.080 \cdot \texttt{marginality.06}_i - \\
&\quad- 0.312 \cdot \texttt{PAN.governor.06}_i
\end{split}
\]

\[
\hat{\textbf{\texttt{PAN.visits.06}}_i} = e^{(-3.810 - 0.081 \cdot \texttt{competitive.district}_i - 2.080 \cdot \texttt{marginality.06}_i - 0.312 \cdot \texttt{PAN.governor.06}_i)}
\]

\vspace{.25cm}
\textbf{Estimating mean number of visits from the winning PAN presidential candidate:}

Given \texttt{competitive.district} = 1, \texttt{marginality.06 = 0}, \texttt{PAN.governor.06} = 1:

\[
\hat{\textbf{\texttt{PAN.visits.06}}_i} = e^{(-3.810 - (0.081 \cdot 1) - (2.080 \cdot 0) - (0.312 \cdot 1)}
\]

\lstinputlisting[language=R, firstline=104, lastline=106]{PS3MS.R} 

\texttt{0.01494818}

 Therefore, the estimated mean number of visits from the winning PAN presidential candidate for a hypothetical district that was competitive, had an average poverty level, and a PAN governor, $\approx 0.015.

\end{enumerate}

\end{document}
